# Global workflow definition path (YAML workflow file - single source of truth)
workflow_definition_path: nexus-core/examples/workflows/enterprise_workflow.yaml

# Shared agent YAML definitions (org-level agents used across all projects)
# Searched as fallback when agent_type is not found in project-specific agents_dir
shared_agents_dir: nexus-core/examples/agents

# VCS-agnostic inbox/tasks directory (can be .nexus, .gitlab, .gitea, etc.)
# Relative to project workspace root
nexus_dir: .nexus

# Project key registry (single source of truth for short keys and aliases)
projects:
  nxs:
    code: nexus
    aliases:
      - nexus core
      - nexus-core

# Merge queue behavior (project-level enforcement)
# review_mode:
#   - manual: PR merge requires human approval
#   - auto: PR can be merged automatically by the queue worker when ready
merge_queue:
  review_mode: manual

# GitHub Issue Triage Configuration
# Maps incoming GitHub issues to agent types (not specific agents)
# 
# Agent types are abstract roles that workflows implement:
#   - triage: Initial issue analysis and classification
#   - escalation: High-priority/urgent issues (escalate to senior agent)
#   - debug: Bug analysis and root cause
#
# Each project's workflow defines which actual agent implements each type.
# Example:
#   - nexus uses enterprise_workflow.yaml: triage → @triage, escalation → @triage (with priority flag)
issue_triage:
  # Default agent type when no specific mapping applies
  # Routes to whatever agent is configured for this type in the current workflow
  default_agent_type: "triage"
  
  # Per-repository agent type override (if different from default)
  per_repo:
    "Ghabs95/nexus-core": "triage" # Nexus core issues use triage workflow

  # Label-based routing to agent types
  label_based:
    "docs": "triage"              # Documentation issues → triage agent
    "good first issue": "triage"  # Beginner issues → triage agent
    "bug": "debug"                # Bugs → debug agent (root cause analysis)
    "urgent": "escalation"        # Urgent → escalation agent (senior review)
    "critical": "escalation"      # Critical → escalation agent

# Global AI tool preferences: which AI tool (and optionally model) to use
# for each AGENT TYPE.
# Valid providers: copilot, gemini, codex
# Model override syntax: tool["model-name"] (e.g., copilot["gpt-4o-mini"])
# When no model is specified, the tool's default model is used.
#
# Architecture:
# 1. Agent YAML files define: spec.agent_type (e.g., "triage", "debug", "escalation")
# 2. Tasks are routed to agent types (not specific agent names)
# 3. The first available agent with that type handles the task
# 4. This config maps type → AI tool, so all agents of that type use the same tool
#
# Example agent YAML:
#   spec:
#     agent_type: "triage"       # This agent handles type: triage
#     provider_preference: null  # Will use value from ai_tool_preferences
ai_tool_preferences:
  triage: copilot["gpt-4o-mini"]        # Lightweight classification task
  designer: gemini                      # UX/UI and product design
  debug: copilot                        # Root-cause analysis
  developer: codex                      # Code implementation
  reviewer: copilot                     # Code/quality review
  compliance: copilot["gpt-4o-mini"]    # Checklist-style security review
  deployer: copilot["gpt-4o-mini"]      # Mechanical deployment steps
  docs: gemini["gemini-2.0-flash"]      # Docs and summaries (fast + cheap)
  writer: gemini["gemini-2.0-flash"]    # Close-loop writing (fast + cheap)
  finalizer: gemini["gemini-2.0-flash"] # Rejected/closure handling (fast + cheap)

# Global operation task -> agent type mapping.
# Provider is selected through ai_tool_preferences for that agent type.
operation_agents:
  default: triage
  classify: triage
  route: triage
  detect_intent: triage
  generate_name: triage
  refine_description: triage
  transcribe_audio: triage

# Project configurations
nexus:
  agents_dir: ghabs/nexus-core/examples/agents
  workspace: nexus
  git_repo: Ghabs95/nexus-core
  # git_repos:
  #  - Ghabs95/nexus-core
  operation_agents:
    default: triage
    refine_description: designer
    overrides:
      issue:
        refine_description: triage
    chat:
      designer:
        context_path: nexus-core/examples/telegram-bot/docs
        context_files:
          - AGENTS.md
      triage: { }
      compliance: { }
      writer: { }
  # Uses the enterprise workflow (multi-tier: full/shortened/fast-track)
  workflow_definition_path: nexus/nexus-core/examples/workflows/enterprise_workflow.yaml
  # AI tool preferences for enterprise workflow agent types
  ai_tool_preferences:
    triage: copilot["gpt-4o-mini"]        # Lightweight classification
    designer: copilot                     # Architecture proposals
    debug: copilot                        # Root cause analysis
    developer: codex                      # Code implementation
    reviewer: copilot                     # PR reviews
    compliance: copilot["gpt-4o-mini"]    # Security/privacy review
    deployer: copilot["gpt-4o-mini"]      # Merge & release
    writer: gemini["gemini-2.0-flash"]    # Docs & close (fast + cheap)
    finalizer: gemini["gemini-2.0-flash"] # Rejected issue close (fast + cheap)
