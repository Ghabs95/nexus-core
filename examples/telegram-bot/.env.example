# Nexus Configuration environment variables
# Copy this to .env and populate with your keys.

# ================================
# BOT TOKENS
# ================================
# Telegram Bot Token (from BotFather)
TELEGRAM_TOKEN=your_telegram_token_here

# Allowed Telegram User IDs (comma-separated)
TELEGRAM_ALLOWED_USER_IDS=123456789,987654321

# Discord Bot Token (from Discord Developer Portal)
DISCORD_TOKEN=your_discord_token_here

# Allowed Discord User ID (Numeric ID of the only authorized user)
DISCORD_ALLOWED_USER_IDS=123456789,987654321

# Discord Guild (Server) ID where the bot will register slash commands
DISCORD_GUILD_ID=123456789

# ================================
# GITHUB INTEGRATION
# ================================
# GitHub Personal Access Token (for the core backend issue processing)
GITHUB_TOKEN=your_github_token_here

# GitHub webhook secret + port for webhook service
WEBHOOK_SECRET=your_webhook_secret_here
WEBHOOK_PORT=8081

# ================================
# GITLAB INTEGRATION
# ================================
# GitLab Personal Access Token (Required if any project uses git_platform: gitlab)
GITLAB_TOKEN=glpat-your_gitlab_token_here

# Optional: Override GitLab Base URL (defaults to https://gitlab.com)
# GITLAB_BASE_URL=https://gitlab.example.com

# ================================
# AI / PERSONA SETTINGS
# ================================
# Base AI system prompt/persona for chat interactions (use a short instruction sentence or paragraph)
AI_PERSONA=You are Nexus, a concise and highly capable technical and business assistant for Ghabs. Be direct, practical, and solution-oriented.

# AI analysis timeout (seconds)
AI_ANALYSIS_TIMEOUT=300
# Max retries before provider is marked unavailable
AI_MAX_RETRIES=3

# Voice transcription provider
# Options: whisper | gemini | copilot
TRANSCRIPTION_PRIMARY=whisper

# Whisper settings (used when TRANSCRIPTION_PRIMARY=whisper)
WHISPER_MODEL=small
WHISPER_LANGUAGES=en,it

# Task confirmation mode
# Options: always | smart | never
TASK_CONFIRMATION_MODE=smart

# ================================
# INFRA / MEMORY SERVICES
# ================================
# Deployment mode
# Options: compose | systemd
DEPLOY_TYPE=compose

# Redis URL for conversational memory and multi-platform state
REDIS_URL=redis://localhost:6379/0

# Workspace base directory (used for relative paths)
BASE_DIR=/home/ubuntu/git

# Runtime state and local workflow-file storage (non-Postgres fallback)
NEXUS_RUNTIME_DIR=/var/lib/nexus
NEXUS_CORE_STORAGE_DIR=/var/lib/nexus/nexus-core

# Project configuration file path
PROJECT_CONFIG_PATH=/opt/nexus/config/project_config.yaml

# Global Nexus storage backend (default for all domains)
# Options: filesystem | postgres
# - postgres: use DB-backed storage where implemented
# - filesystem: local disk paths under NEXUS_RUNTIME_DIR
NEXUS_STORAGE_BACKEND=postgres

# Optional domain overrides (leave unset to inherit NEXUS_STORAGE_BACKEND)
# NEXUS_WORKFLOW_BACKEND=postgres
# NEXUS_INBOX_BACKEND=postgres

# Backward compatibility alias (legacy): NEXUS_STORAGE_TYPE=file|postgres
# NEXUS_STORAGE_TYPE=postgres

# Storage DSN used when a postgres backend is selected
NEXUS_STORAGE_DSN=postgresql://nexus:change_me@127.0.0.1:5432/nexus

# Postgres inbox dedupe windows (seconds)
# - NEXUS_INBOX_DEDUPE_WINDOW_SECONDS: exact payload dedupe window
# - NEXUS_INBOX_DONE_DEDUPE_WINDOW_SECONDS: suppress re-enqueue of same filename
#   after successful processing (prevents duplicate issue creation on replayed IDs)
# NEXUS_INBOX_DEDUPE_WINDOW_SECONDS=900
# NEXUS_INBOX_DONE_DEDUPE_WINDOW_SECONDS=86400

# Implemented-feature registry + ideation dedup controls
NEXUS_FEATURE_REGISTRY_ENABLED=true
NEXUS_FEATURE_REGISTRY_MAX_ITEMS_PER_PROJECT=500
NEXUS_FEATURE_REGISTRY_DEDUP_SIMILARITY=0.86

# Completion replay guard on inbox-processor startup (seconds)
# Completion summaries older than this window at startup are ignored.
NEXUS_COMPLETION_REPLAY_WINDOW_SECONDS=1800

# ================================
# SLACK INTEGRATION
# ================================
# Slack Bot OAuth Token (xoxb-...) — requires chat:write, commands scopes
SLACK_TOKEN=xoxb-your_bot_token_here

# Slack App-Level Token (xapp-...) — required for Socket Mode (connections:write scope)
SLACK_APP_TOKEN=xapp-your_app_token_here

# Slack Signing Secret — used by Bolt for request signature verification
SLACK_SIGNING_SECRET=your_signing_secret_here

# Comma-separated Slack User IDs allowed to interact with the bot
SLACK_ALLOWED_USER_IDS=U123456789,U987654321

# Default Slack channel for system alert notifications
SLACK_DEFAULT_CHANNEL=#ops
